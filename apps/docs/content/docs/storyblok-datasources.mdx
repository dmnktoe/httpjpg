---
title: Storyblok Datasources
description: Automatische Synchronisation von Design Tokens zu Storyblok Datasources f√ºr den Visual Editor
---

## üéØ √úberblick

Dieses System synchronisiert Ihre Design Tokens (`@httpjpg/tokens`) automatisch mit Storyblok Datasources, damit Redakteure im Visual Editor benutzerfreundliche Dropdowns statt technischer Werte sehen.

## üìä Erstelle Datasources

### 1. Umgebungsvariablen einrichten

Erstellen Sie eine `.env.local` Datei im Root:

```bash
# Storyblok Management API (f√ºr Datasource-Sync)
STORYBLOK_MANAGEMENT_TOKEN=your_personal_access_token
STORYBLOK_SPACE_ID=your_space_id
```

**Token erstellen:**
1. √ñffne [Storyblok Account Settings](https://app.storyblok.com/#!/me/account?tab=token)
2. Erstelle einen **Personal Access Token**
3. Kopiere den Token in `.env.local`

**Space ID finden:**
1. √ñffne dein Storyblok Space
2. Settings ‚Üí General
3. Die Space ID ist die Nummer in der URL: `https://app.storyblok.com/#!/me/spaces/[SPACE_ID]`

### 2. Datasources synchronisieren

```bash
# Im Root des Projekts
pnpm --filter @httpjpg/tokens sync:storyblok
```

Das Script erstellt/aktualisiert folgende Datasources:

- **`spacing-options`** - None, XS, Small, Medium, Large, XL, 2XL, 3XL, 4XL
- **`background-color-options`** - White, Black, Light Gray, Gray, Dark Gray, Primary, Accent
- **`width-options`** - Full Width, Container, Narrow
- **`aspect-ratio-options`** - 16:9, 4:3, 1:1, 3:4, 9:16, 21:9

## üîß In Storyblok Component Schema verwenden

### Beispiel: Section Component

```json
{
  "name": "section",
  "display_name": "Section",
  "schema": {
    "padding_top": {
      "type": "option",
      "display_name": "Padding Top",
      "datasource": "spacing-options",
      "default_value": "Medium"
    },
    "padding_bottom": {
      "type": "option",
      "display_name": "Padding Bottom",
      "datasource": "spacing-options",
      "default_value": "Medium"
    },
    "bg_color": {
      "type": "option",
      "display_name": "Background Color",
      "datasource": "background-color-options",
      "default_value": "White"
    },
    "width": {
      "type": "option",
      "display_name": "Width",
      "datasource": "width-options",
      "default_value": "Container"
    }
  }
}
```

## üíª Im Code verwenden

Die Mapping-Funktionen konvertieren Datasource-Werte automatisch zu Tokens:

```typescript
import { mapSpacingToToken } from "@httpjpg/storyblok-ui/lib/spacing-utils";
import { mapColorToToken } from "@httpjpg/storyblok-ui/lib/token-mapping";

// Im Component
<Section
  css={{
    pt: mapSpacingToToken(blok.paddingTop),  // "Medium" ‚Üí "8"
    bg: mapColorToToken(blok.bgColor),        // "White" ‚Üí "white"
  }}
>
  {children}
</Section>
```

## üîÑ Workflow

### Entwickler (Code):

1. Design Tokens in `packages/tokens/src/` bearbeiten
2. `pnpm --filter @httpjpg/tokens sync:storyblok` ausf√ºhren
3. Datasources sind automatisch aktualisiert

### Redakteure (Storyblok):

1. √ñffne Story im Visual Editor
2. W√§hle "Medium" aus Dropdown (nicht "8")
3. Code verwendet automatisch `spacing[8]`

## üìù Mapping-Funktionen

### `mapSpacingToToken(value)`

Konvertiert Datasource-Labels zu Spacing-Tokens:

| Datasource Value | Token | CSS Output |
|-----------------|-------|------------|
| None | 0 | 0 |
| XS | 2 | 0.5rem |
| Small | 4 | 1rem |
| Medium | 8 | 2rem |
| Large | 16 | 4rem |
| XL | 24 | 6rem |
| 2XL | 32 | 8rem |

### `mapColorToToken(value)`

Konvertiert Datasource-Labels zu Color-Tokens:

| Datasource Value | Token | CSS Output |
|-----------------|-------|------------|
| White | white | #FFFFFF |
| Black | black | #000000 |
| Light Gray | neutral.50 | #FAFAFA |
| Gray | neutral.100 | #F5F5F5 |
| Primary | primary.500 | #F43F5E |

### `mapWidthToToken(value)`

Konvertiert Width-Labels:

| Datasource Value | Token |
|-----------------|-------|
| Full Width | full |
| Container | container |
| Narrow | narrow |

### `mapAspectRatioToToken(value)`

Konvertiert Aspect Ratio-Labels:

| Datasource Value | Token |
|-----------------|-------|
| 16:9 (Landscape) | 16/9 |
| 4:3 (Standard) | 4/3 |
| 1:1 (Square) | 1/1 |

## ‚ú® Vorteile

### F√ºr Redakteure:
- ‚úÖ Benutzerfreundliche Labels ("Medium" statt "8")
- ‚úÖ Konsistente Design-Auswahl
- ‚úÖ Keine technischen Werte

### F√ºr Entwickler:
- ‚úÖ Single Source of Truth in Code
- ‚úÖ Type Safety bleibt erhalten
- ‚úÖ Automatische Synchronisation
- ‚úÖ Keine manuelle Pflege in Storyblok

## üîÑ Updates

Wenn Sie neue Spacing-Werte oder Farben hinzuf√ºgen:

1. Tokens in `packages/tokens/src/` aktualisieren
2. Sync-Script in `packages/tokens/scripts/sync-storyblok-datasources.ts` anpassen
3. `pnpm --filter @httpjpg/tokens sync:storyblok` ausf√ºhren
4. Component Schemas in Storyblok bleiben unver√§ndert

## üö® Wichtig

- **Niemals** Token-Werte direkt in Storyblok eingeben
- **Immer** Datasources verwenden f√ºr wiederverwendbare Werte
- **Regelm√§√üig** synchronisieren nach Token-√Ñnderungen
- **.env.local** nicht committen (bereits in .gitignore)

## üìö Weitere Ressourcen

- [Storyblok Datasources Docs](https://www.storyblok.com/docs/guide/in-depth/datasources)
- [Management API Docs](https://www.storyblok.com/docs/api/management)
- Design Tokens: `packages/tokens/src/`
- Mapping Utils: `packages/storyblok-ui/src/lib/`
